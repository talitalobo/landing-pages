---
title: "Intervalos de Confiança"
author: "Análise de Dados I"
output: html_document
---

```{r, echo=FALSE, warning=FALSE}
require("Rmisc", quietly=T, warn.conflicts=F)
require("asbio", quietly=T, warn.conflicts=F)
```

```{r, echo=FALSE, warning=FALSE}

prop.acertos.media <- function(populacao, n.Amostras, tamAmostra){
  
  amostras <- data.frame(upper = numeric(nAmostras), mean = numeric(nAmostras), lower = numeric(nAmostras))

  for(i in 1:nAmostras){
    amostra <- sample(populacao, tamAmostra)
    amostras[i,] <- CI(amostra)
  }
  
  pop.media <- mean(populacao)
  amostras$cont.pop.media <- (amostras$upper >= pop.media & amostras$lower <= pop.media)
  
  return(prop.table(table(amostras$cont.pop.media)))
}




prop.acertos.mediana <- function(populacao, n.Amostras, tamAmostra){
  
  amostras <- data.frame(median = numeric(nAmostras), lower = numeric(nAmostras), upper = numeric(nAmostras))
  
  for(i in 1:nAmostras){
    amostra <- sample(populacao, tamAmostra)
    amostras[i,] <- ci.median(amostra)$ci
  }
  
  pop.mediana <- median(populacao)
  amostras$cont.pop.mediana <- (amostras$upper >= pop.mediana & amostras$lower <= pop.mediana)
  
  return(prop.table(table(amostras$cont.pop.mediana)))
}

nAmostras <- 500
nObservacoes <- 25

populacao.norm <- rnorm(100)
outliers <- c(30,20,10)
```


### Caso 1: Cálculo da média para população normal
```{r, warning=FALSE}
prop.acertos.media(populacao.norm, nAmostras, nObservacoes)
```

### Caso 2: Cálculo da média para população normal com outliers
```{r, warning=FALSE}
populacao.norm.out <- c(populacao.norm, outliers)
prop.acertos.media(populacao.norm.out, nAmostras, nObservacoes)
```

### Caso 3: Cálculo da mediana para população normal
```{r, warning=FALSE}
prop.acertos.mediana(populacao.norm, nAmostras, nObservacoes)
```

### Caso 4: Cálculo da mediana para população normal com outliers
```{r, warning=FALSE}
prop.acertos.mediana(populacao.norm.out, nAmostras, nObservacoes)
```


# o processo é o seguinte: 

# 1. pega uma amostra de uma população mais ou menos normal (melhor se não for exatamente normal). fazendo 500 ICs para a média com 95% de confiança, esperamos que 95% dos ICs contenham a média da população. 

# 2. pega uma amostra de uma população beem enviesada (tipo uma exponencial, ou uma com uns outliers). esperamos que menos de 95% dos ICs contenham a média da população. (eu demonstrei isso no rpubs que compartilhei lá, na verdade). 

# 3. repete 1 e 2 usando a estimativa da mediana. eu não tenho certeza, mas acho que não vai quebrar quando mudarmos a distribuição. 

# 4. fazer 1 e 2 com o t.test, avaliando se a média das amostras é significativamente diferente da média da população. 

# 5. fazer 1 e 2 com o wilcoxon.test


nazareno [6:56 PM]
talita: quando você for mexer nisso, o que eu queria mostrar era que testes e procedimentos paramétricos em geral não têm a probabilidade de acerto que prometem quando a amostra é muito enviesada ou tem outliers

nazareno [6:57 PM]
aí pelo que entendi, allan mostrou isso pra IC, mas seria legal entender por que o t-teste não quebra também. talvez seja minha pergunta que está errada
